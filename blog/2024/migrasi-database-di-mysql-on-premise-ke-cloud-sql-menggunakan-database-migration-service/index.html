<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <blockquote> <em>Original post: </em><a href="https://misskecupbung.wordpress.com/2024/01/17/google-cloud-migrasi-database-di-mysql-on-premise-ke-cloud-sql-menggunakan-database-migration-service/" rel="external nofollow noopener" target="_blank"><em>Google Cloud: Migrasi Database di MySQL On-Premise ke Cloud SQL menggunakan Database Migration Service</em></a> </blockquote> <p>Halo semua!</p> <p>Selamat siang! Apa kabar? Jumpa lagi di Jurnal saya ya! Sudah lama tidak update dan disini saya ingin memulai tahun 2024 dengan topik <strong>migrasi database MySQL di on-premise ke Cloud SQL menggunakan Database Migration Service.</strong></p> <p>Yup!</p> <p>Mengapa harus menggunakan Database Migration Service? Sebenarnya bisa saja kita menggunakan tool semacam mysqldump untuk <em>dump</em> database di on-premise dan <em>restore</em> di Cloud SQL. Itu cara termudah dan tidak perlu layanan tambahan seperti Database Migration Service. Hanya saja hal tersebut memiliki kekurangan salah satunya aplikasi haruslah downtime.</p> <p>Mengapa? karena jika kita menggunakan tool mysqldump sedangkan aplikasi masih dalam keadaan up dan running, maka ditakutkan adanya inkonsistensi data. Data yang ingin dipidahkan haruslah data terbaru dan tidak rusak.</p> <p>Selain itu juga, jika data yang ingin dipindahkan berukuran sangat besar sehingga akan memakan waktu yang lama, maka solusi yang tepat adalah menggunakan layanan tambahan seperti Database Migration Service. Intinya, kita ingin memindahkan database dari MySQL on-premise (misal di atas instance) ke Cloud SQL tanpa ingin mematikan aplikasi dan ingin data tetap utuh dan konsisten.</p> <p>Bagaimana cara kerja Database Migration Service?</p> <p>Pertama, kita perlu membuat <em>connection profile</em> yang berisi detail database yang berada di on-premise seperti <em>IP Address</em>, <em>username</em> dan <em>password</em> yang memiliki hak akses. Selanjutnya kita buat job di DBMS berisi detail seperti tipe migrasi (apakah continuous atau one-time), profile database sumber dan tujuan, serta metode koneksi apa yang ingin dipakai untuk migrasi.</p> <p>Mari kita mulai.</p> <p>Sebelum memulai pastikan kedua API dibawah ini, yaitu <strong>Database Migration API</strong> dan <strong>Service Networking API.</strong></p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1022/0*ov4q0jbz7XCxhD9E"></figure> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*ZmgWDH5vvI9y3ZZM"></figure> <p>Di bawah ini adalah <strong>VM instance</strong> yang berisi database yang akan kita migrasi ke Cloud SQL.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1022/0*IczXzJqoPrWrPEha"></figure> <p>Selanjutnya, buka layanan DBMS dengan tampilan seperti berikut:</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1022/0*HwbRV-Ob_FpfZFmV"></figure> <p>Pertama, kita buat <em>connection profile</em>. Klik <strong>Create Profile.</strong></p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1022/0*IO0slR4ntSXaY9YI"></figure> <p>Ada beberapa database engine yang didukung oleh Google Cloud, khususnya untuk MySQL dan PostgreSQL. Disini saya pilih MySQL.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*EyxkIKxCUwUmvLS5"></figure> <p>Isikan detail koneksi dari database yang berada di on-premise seperti <em>Hostname/IP Address</em>, <em>port</em>, <em>username</em>, dan <em>password</em>. Untuk <em>connection profile region</em> pilih region dimana Cloud SQL akan ditempatkan. Lalu klik <strong>Create</strong>.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*PeLXqLfCDr4ySNgi"></figure> <p>Selanjutnya, kita tinggal buat job migrasinya! Klik <em>Create a migration job</em> dan isi detail yang terdiri dari 5 tahap.</p> <p>Pertama, isikan nama job, database engine, dan tipe job migrasi. Apa bedanya? untuk <em>Continuous</em> sendiri saat proses migrasi selesai, antara MySQL di on-premise dan Cloud SQL akan sama-sama <em>running</em> dan ketika ada data baru di on-premise maka akan secara otomatis direplika sampai migrasi dicut/promote sehingga kita bisa verifikasi. Sedangkan one-time, seperti namanya, migrasi hanya akan dilakukan sekali.</p> <p>Disini saya pilih <strong>Continuous</strong>.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*uFHATLXr5xC_V1VU"></figure> <p>Langkah kedua pilih <em>connection profile</em> yang telah dibuat sebelumnya.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*Ps_IseOrRX5UuU-_"></figure> <p>Langkah ketiga atur tujuan instance, disini saya karena belum punya Cloud SQL instance, maka saya pilih <strong>New Instance</strong> dan atur detailnya.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*J9eLnYCLL7UI8Z2k"></figure> <p>Pada langkah keempat adalah mengatur koneksi apa yang dipilih untuk DBMS melakukan migrasi. Ada tiga pilihan, yaitu <em>IP allowlist, Reverse-SSH tunnel, </em>dan <em>VPC peering</em>.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*KgASbxBuWOI7bkhf"></figure> <p>Ketiganya bisa dipilih salah satu, dan karena disini MySQL on-premise saya simulasikan di VM instance, saya pilih VPC peering.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*p4B2f_jwfSAxyrHp"></figure> <p>Langkah kelima bisa direview dan untuk memastikan koneksi aman dan migrasi berhasil bisa <strong>Test Job.</strong></p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*grk97yx7Ez2Gexse"></figure> <p>Pastikan centang hijau! Klik <strong>Create &amp; Start Job</strong> untuk mulai migrasi.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*dB0QdvWWZDysJb0l"></figure> <p>Tampilan proses job migrasi</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1021/0*-SppBmtibvQZ1_Im"></figure> <p>Berikut tampilan Cloud SQL instance.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1021/0*0XiG4LJeRtLzdQhO"></figure> <p>Bisa verifikasi menggunakan SQL query.</p> <pre>gcloud sql connect mysql-cloudsql -user=root --quiet</pre> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/0*y85QMfjWWrQVgRUa"></figure> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*L4jcB2QXcBMIB4Uc"></figure> <p>Dari tampilan di atas migrasi database kita berhasil! Yeay!</p> <p>Karena kita pilih <em>Continuous</em>, maka selama job masih running maka data baru yang masuk ke instance akan otomatis direplika ke Cloud SQL. Hal ini biasanya dilakukan untuk melakukan verifikasi dan memastikan data tidak ada yang tertinggal.</p> <p>Jika sudah selesai kita bisa lakukan cutover dengan klik <strong>Promote </strong>di job migrasi.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1022/0*bo33NEYSvl1Aigy0"></figure> <p>Tunggu sampai selesai dan status akan berubah menjadi <strong>Completed</strong>.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1022/0*zI133OqfF-gUGdbz"></figure> <p>Migrasi database kita sukses dan selesai!</p> <p>Sekian!</p> <p>Sumber:</p> <ul><li><a href="https://cloud.google.com/database-migration" rel="external nofollow noopener" target="_blank">https://cloud.google.com/database-migration</a></li></ul> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=c5547f9baebd" width="1" height="1" alt="">&lt;hr&gt;&lt;p&gt;<a href="https://medium.com/google-cloud-indonesia/migrasi-database-di-mysql-on-premise-menggunakan-database-migration-service-ke-cloud-sql-c5547f9baebd" rel="external nofollow noopener" target="_blank">Migrasi Database di MySQL On-Premise ke Cloud SQL menggunakan Database Migration Service</a> was originally published in <a href="https://medium.com/google-cloud-indonesia" rel="external nofollow noopener" target="_blank">Google Cloud Indonesia</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;</p> </body></html>